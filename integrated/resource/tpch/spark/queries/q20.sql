SELECT
	S_NAME,
	S_ADDRESS
FROM
	supplier,
	nation
WHERE
	S_SUPPKEY IN (
	SELECT
		PS_SUPPKEY
	FROM
		partsupp
	WHERE
	PS_PARTKEY IN (
		SELECT
			P_PARTKEY
		FROM
			part
		WHERE
			P_NAME LIKE 'green%'
	)
	AND PS_AVAILQTY > (
		SELECT
			0.5 * SUM(L_QUANTITY)
		FROM
			lineitem
		WHERE
			L_PARTKEY = PS_PARTKEY
		AND L_SUPPKEY = PS_SUPPKEY
		AND L_SHIPDATE >= DATE '1993-01-01'
		AND L_SHIPDATE < DATE '1994-01-01'
		)
	)
	AND S_NATIONKEY = N_NATIONKEY
	AND N_NAME = 'ALGERIA'
ORDER BY
	S_NAME
